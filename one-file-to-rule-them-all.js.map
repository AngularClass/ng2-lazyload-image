{"version":3,"sources":["webpack:///./example/boot.ts","webpack:///./example/app.component.ts","webpack:///./example/image.component.ts","webpack:///./src/lazy-load-image.directive.ts"],"names":["AppComponent","AppComponent.constructor","ImageComponent","ImageComponent.constructor","LazyLoadImageDirective","LazyLoadImageDirective.constructor","LazyLoadImageDirective.ngAfterContentInit","LazyLoadImageDirective.loadImage","LazyLoadImageDirective.setImage","LazyLoadImageDirective.setLoadedStyle","LazyLoadImageDirective.isVisible","LazyLoadImageDirective.updateViewportOffset","LazyLoadImageDirective.ngOnDestroy"],"mappings":"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","file":"one-file-to-rule-them-all.js","sourcesContent":["import 'es6-shim';\nimport 'reflect-metadata';\nimport 'rxjs';\nimport 'zone.js/dist/zone-microtask';\nimport 'zone.js/dist/long-stack-trace-zone';\nimport {bootstrap} from 'angular2/platform/browser';\nimport {AppComponent} from './app.component';\n\nbootstrap(AppComponent);\n\n\n\n/** WEBPACK FOOTER **\n ** ./example/boot.ts\n **/","import {Component} from 'angular2/core';\nimport {ImageComponent} from './image.component';\n\n@Component({\n    selector: 'my-app',\n    template: `\n        <image *ngFor=\"#image of images\" [src]=\"image\"></image>\n    `,\n    directives: [ImageComponent]\n})\nclass AppComponent {\n\n    images = [\n        'https://images.unsplash.com/photo-1431887773042-803ed52bed26?fm=jpg',\n        'https://images.unsplash.com/photo-1443890923422-7819ed4101c0?fm=jpg',\n        'https://images.unsplash.com/photo-1448960968772-b63b3f40dfc1?fm=jpg',\n        'https://images.unsplash.com/photo-1432256851563-20155d0b7a39?fm=jpg'\n    ];\n\n}\n\nexport {AppComponent};\n\n\n\n/** WEBPACK FOOTER **\n ** ./example/app.component.ts\n **/","import {Component, Input} from 'angular2/core';\nimport {LazyLoadImageDirective} from '../src/lazy-load-image.directive';\n\n@Component({\n    selector: 'image',\n    styles: [`\n        img {\n            width: 100%;\n            min-height: 1000px;\n            transition: opacity 1s;\n            opacity: 0;\n        }\n\n        img.ng2-lazyloaded {\n            opacity: 1;\n        }\n    `],\n    template: `\n        <img src=\"https://www.placecage.com/1000/1000\" [lazyLoad]=\"image\" offset=\"0\">\n    `,\n    directives: [LazyLoadImageDirective]\n})\nclass ImageComponent {\n    @Input('src') image;\n}\n\nexport {ImageComponent};\n\n\n\n/** WEBPACK FOOTER **\n ** ./example/image.component.ts\n **/","import {Directive, ElementRef, Input} from 'angular2/core';\nimport {Observable, Subscription} from 'rxjs';\n\n@Directive({\n    selector: '[lazyLoad]'\n})\nclass LazyLoadImageDirective {\n    @Input('lazyLoad') lazyImage;\n    @Input('src') defaultImg;\n    @Input() offset;\n    elementRef: ElementRef;\n    scrollSubscription: Subscription;\n    viewportSize = {\n        height: 0,\n        width: 0\n    };\n\n    constructor(el: ElementRef) {\n        this.elementRef = el;\n    }\n\n    ngAfterContentInit() {\n        this.updateViewportOffset();\n\n        this.scrollSubscription = Observable\n            .merge(\n                Observable.of(1), // Fake a scroll event\n                Observable.fromEvent(window, 'scroll')\n            )\n            .sampleTime(100)\n            .filter(() => this.isVisible())\n            .switchMap(() => this.loadImage(this.lazyImage))\n            .map(() => this.setImage(this.lazyImage))\n            .finally(() => this.setLoadedStyle())\n            .subscribe(\n                () => this.ngOnDestroy(),\n                error => {\n                    this.setImage(this.defaultImg);\n                    this.ngOnDestroy();\n                }\n            );\n    }\n\n    loadImage(image) {\n        return Observable\n            .create(observer => {\n                const img = new Image();\n                img.src = image;\n                img.onload = () => {\n                    observer.next(img);\n                    observer.complete();\n                };\n                img.onerror = err => {\n                    observer.error(err);\n                    observer.complete();\n                };\n            });\n    }\n\n    setImage(image) {\n        this.elementRef.nativeElement.src = image;\n    }\n\n    setLoadedStyle() {\n        const styles = this.elementRef.nativeElement.className\n            .split(' ')\n            .filter(s => !!s)\n            .filter(s => s !== 'ng2-lazyloading');\n        styles.push('ng2-lazyloaded');\n        this.elementRef.nativeElement.className = styles;\n    }\n\n    isVisible() {\n        const rect = this.elementRef.nativeElement.getBoundingClientRect();\n        return (\n            rect.top >= 0 &&\n            rect.left >= 0 &&\n            (rect.bottom - rect.height) <= this.viewportSize.height &&\n            (rect.right - rect.width) <= this.viewportSize.width\n        );\n    }\n\n    updateViewportOffset() {\n        this.viewportSize.height = (window.innerHeight || document.documentElement.clientHeight) + (this.offset | 0);\n        this.viewportSize.width = (window.innerWidth || document.documentElement.clientWidth) + (this.offset | 0);\n    }\n\n    ngOnDestroy() {\n        [this.scrollSubscription]\n            .filter(subscription => subscription && !subscription.isUnsubscribed)\n            .forEach(subscription => subscription.unsubscribe());\n    }\n}\n\nexport {LazyLoadImageDirective};\nexport default LazyLoadImageDirective;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lazy-load-image.directive.ts\n **/"],"sourceRoot":""}